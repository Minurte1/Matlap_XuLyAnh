% B??c 1: ??c ?nh
r = imread('Fig0304(a)(breast_digital_Xray).tif');  % ??c ?nh g?c
figure;
imshow(r); % Hi?n th? ?nh g?c
title('?nh g?c');

% B??c 2: Phân tích s? phân b? m?c xám c?a ?nh
figure;
imhist(r);  % V? bi?u ?? phân b? m?c xám
title('Bi?u ?? phân b? m?c xám c?a ?nh g?c');

% B??c 3: Bi?n ??i âm b?n ?nh
L = 256;  % S? m?c xám c?a ?nh (8 bit)
sa = L - 1 - r;  % Bi?n ??i âm b?n ?nh
figure;
imshow(sa);  % Hi?n th? ?nh âm b?n
title('?nh âm b?n');

% B??c 4: So sánh l??c ?? xám c?a ?nh g?c và ?nh âm b?n
figure;
subplot(1, 2, 1);  % ??t 2 ?nh bên c?nh nhau
imhist(r);  % Bi?u ?? xám c?a ?nh g?c
title('L??c ?? xám ?nh g?c');

subplot(1, 2, 2);
imhist(sa);  % Bi?u ?? xám c?a ?nh âm b?n
title('L??c ?? xám ?nh âm b?n');

% B??c 5: T?o ?nh nh? phân v?i ng??ng t = 127
t = 127;  % Ng??ng t
binary_image = r >= t;  % T?o ?nh nh? phân (1 n?u pixel >= 127, 0 n?u < 127)

figure;
imshow(binary_image);  % Hi?n th? ?nh nh? phân
title('?nh nh? phân v?i ng??ng t = 127');
